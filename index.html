<!DOCTYPE html>
<!-- 
    HTML Structure for Stock Analysis Dashboard
    This is a single-page application for analyzing Reliance Power (RPOWER) stock data
    It uses Lightweight Charts library for rendering interactive stock charts
-->
<html lang="en">
<head>
    <!-- 
        Meta tags for character encoding and responsive viewport 
        charset: UTF-8 ensures proper display of all characters
        viewport: enables responsive design for different screen sizes
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Page title displayed in browser tab -->
    <title>Reliance Power | Stock Analysis</title>
    
    <!-- 
        External library: Lightweight Charts by TradingView
        This is a high-performance JavaScript library for rendering financial charts
        Version 4.1.0 loaded from CDN
    -->
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
    
    <!-- Google Fonts preconnect for performance optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- 
        Google Fonts: Inter font family
        Inter is a clean, modern sans-serif font optimized for screens
        Weights used: 300 (light), 400 (regular), 500 (medium), 600 (semibold), 700 (bold)
    -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 
        Loading Overlay
        Displayed while data is being loaded and parsed
        Hidden once initialization is complete via JavaScript
    -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loader"></div>
    </div>

    <!-- 
        Floating Tooltip
        Appears on chart hover to show detailed price and indicator data
        Initially hidden, shown via JavaScript on crosshair movement
    -->
    <div class="floating-tooltip" id="tooltip"></div>

    <!-- Main container limits width and centers content -->
    <div class="container">
        <!-- 
            Header Section
            Contains brand/logo, stock name, and live indicator
        -->
        <header>
            <div class="header-content">
                <!-- Brand section with logo and title -->
                <div class="brand">
                    <!-- Logo: RP initials in gradient box -->
                    <div class="logo">RP</div>
                    <div>
                        <h1>Reliance Power</h1>
                        <p class="subtitle">Real-time Stock Analysis</p>
                    </div>
                </div>
                
                <!-- Live indicator showing stock ticker -->
                <div class="live-indicator">
                    <span class="live-dot"></span>
                    <span>NSE: RPOWER</span>
                </div>
            </div>
        </header>

        <!-- 
            Stats Grid
            Displays key stock metrics in card format
        -->
        <div class="stats-grid">
            <!-- Current Price Card -->
            <div class="stat-card">
                <div class="stat-label">Current Price</div>
                <div class="stat-value neutral" id="currentPrice">-</div>
            </div>
            
            <!-- Price Change Card (colored based on positive/negative) -->
            <div class="stat-card">
                <div class="stat-label">Price Change</div>
                <div class="stat-value" id="priceChange">-</div>
            </div>
            
            <!-- Period High Card -->
            <div class="stat-card">
                <div class="stat-label">Period High</div>
                <div class="stat-value neutral" id="periodHigh">-</div>
            </div>
            
            <!-- Period Low Card -->
            <div class="stat-card">
                <div class="stat-label">Period Low</div>
                <div class="stat-value neutral" id="periodLow">-</div>
            </div>
            
            <!-- Average Volume Card -->
            <div class="stat-card">
                <div class="stat-label">Avg Volume</div>
                <div class="stat-value neutral" id="avgVolume">-</div>
            </div>
        </div>

        <!-- 
            Chart Wrapper
            Main chart area with controls
        -->
        <div class="chart-wrapper">
            <!-- Chart header with title and control buttons -->
            <div class="chart-header">
                <span class="chart-title">Price Chart</span>
                
                <!-- Time range buttons: 1D, 1W, 1M -->
                <div class="chart-controls">
                    <div class="btn-group">
                        <button class="btn" id="btnDay" onclick="switchTimeRange('day')">1D</button>
                        <button class="btn" id="btnWeek" onclick="switchTimeRange('week')">1W</button>
                        <button class="btn" id="btnMonth" onclick="switchTimeRange('month')">1M</button>
                    </div>
                    
                    <!-- Chart type toggle: Candle or Line -->
                    <div class="btn-group">
                        <button class="btn active" id="btnCandle" onclick="switchChart('candle')">Candle</button>
                        <button class="btn" id="btnLine" onclick="switchChart('line')">Line</button>
                    </div>
                </div>
            </div>
            
            <!-- 
                Indicator Toggle Buttons
                Users can enable/disable various technical indicators
            -->
            <div class="indicators-header">
                <!-- SMA: Simple Moving Averages (50 and 200 periods) -->
                <button class="btn outline indicator-btn active" id="btnSMA" onclick="toggleIndicator('sma')">SMA (50, 200)</button>
                
                <!-- BB: Bollinger Bands -->
                <button class="btn outline indicator-btn" id="btnBB" onclick="toggleIndicator('bb')">Bollinger Bands</button>
                
                <!-- RSI: Relative Strength Index -->
                <button class="btn outline indicator-btn" id="btnRSI" onclick="toggleIndicator('rsi')">RSI</button>
                
                <!-- MACD: Moving Average Convergence Divergence -->
                <button class="btn outline indicator-btn" id="btnMACD" onclick="toggleIndicator('macd')">MACD</button>
                
                <!-- Volume: Trading volume histogram -->
                <button class="btn outline indicator-btn active" id="btnVolume" onclick="toggleIndicator('volume')">Volume</button>
            </div>
            
            <!-- Legend showing active indicators with their colors -->
            <div id="indicatorLegend" class="indicator-legend"></div>
            
            <!-- 
                Chart Containers
                Different chart types are shown/hidden based on user selection
            -->
            <div id="candleChart"></div>
            <div id="lineChart" class="hidden"></div>
            
            <!-- 
                Indicator Panel Containers
                These hold separate charts for Volume, RSI, and MACD
                Only visible when corresponding indicator is active
            -->
            <div id="volumeChart" class="indicator-panel active"></div>
            <div id="rsiChart" class="indicator-panel"></div>
            <div id="macdChart" class="indicator-panel"></div>
        </div>

        <!-- 
            Panels Grid
            Two side-by-side panels showing additional data
        -->
        <div class="panels-grid">
            <!-- Performance Metrics Panel -->
            <div class="panel">
                <h3>Performance Metrics</h3>
                <div class="data-row"><span class="data-label">Total Periods</span><span id="totalPeriods">-</span></div>
                <div class="data-row"><span class="data-label">Best Period</span><span id="bestPeriod" class="performance-positive">-</span></div>
                <div class="data-row"><span class="data-label">Worst Period</span><span id="worstPeriod" class="performance-negative">-</span></div>
                <div class="data-row"><span class="data-label">Positive Periods</span><span id="positivePeriods">-</span></div>
                <div class="data-row"><span class="data-label">Negative Periods</span><span id="negativePeriods">-</span></div>
            </div>
            
            <!-- Technical Indicators Panel -->
            <div class="panel">
                <h3>Technical Indicators</h3>
                <div class="data-row"><span class="data-label sma-50">SMA 50</span><span id="sma50Value">-</span></div>
                <div class="data-row"><span class="data-label sma-200">SMA 200</span><span id="sma200Value">-</span></div>
                <div class="data-row"><span class="data-label rsi-line">RSI (14)</span><span id="rsiValue">-</span></div>
                <div class="data-row"><span class="data-label macd-line">MACD</span><span id="macdValue">-</span></div>
                <div class="data-row"><span class="data-label">Signal Line</span><span id="signalValue">-</span></div>
            </div>
        </div>

        <!-- 
            Statistics Table
            Shows mean and variance for different time periods
            Displays daily, weekly, and monthly statistics
        -->
        <div class="panel" style="margin-bottom: 32px;">
            <h3>Price Statistics (Mean & Variance)</h3>
            <div class="stats-table-wrapper">
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>Variable</th>
                            <th>Daily Mean</th>
                            <th>Daily Variance</th>
                            <th>Weekly Mean</th>
                            <th>Weekly Variance</th>
                            <th>Monthly Mean</th>
                            <th>Monthly Variance</th>
                        </tr>
                    </thead>
                    <!-- Table body populated by JavaScript -->
                    <tbody id="statsTableBody"></tbody>
                </table>
            </div>
        </div>

        <!-- 
            Footer
            Disclaimer about data usage
        -->
        <footer style="text-align: center; padding: 24px; color: var(--text-tertiary); font-size: 0.85rem; border-top: 1px solid var(--border-color);">
            <p>Data provided for informational purposes only. Not financial advice.</p>
        </footer>
    </div>

    <!-- Link to external JavaScript file -->
    <script src="app.js"></script>
</body>
</html>
